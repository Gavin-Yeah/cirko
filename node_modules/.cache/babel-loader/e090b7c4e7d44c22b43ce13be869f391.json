{"ast":null,"code":"import \"antd-mobile/lib/button/style\";\nimport _Button from \"antd-mobile/lib/button\";\nimport \"antd-mobile/lib/image-picker/style\";\nimport _ImagePicker from \"antd-mobile/lib/image-picker\";\nimport \"antd-mobile/lib/wing-blank/style\";\nimport _WingBlank from \"antd-mobile/lib/wing-blank\";\nimport \"antd-mobile/lib/carousel/style\";\nimport _Carousel from \"antd-mobile/lib/carousel\";\nimport \"antd-mobile/lib/icon/style\";\nimport _Icon from \"antd-mobile/lib/icon\";\nimport \"antd-mobile/lib/input-item/style\";\nimport _InputItem from \"antd-mobile/lib/input-item\";\nimport \"antd-mobile/lib/flex/style\";\nimport _Flex from \"antd-mobile/lib/flex\";\nimport \"antd-mobile/lib/slider/style\";\nimport _Slider from \"antd-mobile/lib/slider\";\nimport \"antd-mobile/lib/toast/style\";\nimport _Toast from \"antd-mobile/lib/toast\";\nimport \"antd-mobile/lib/list-view/style\";\nimport _ListView from \"antd-mobile/lib/list-view\";\nvar _jsxFileName = \"/Users/jiadaye/workspace/cirko/src/components/Home/PostPage/index.js\";\nimport React from 'react';\nimport * as ROUTES from \"../../../constants/routes\";\nimport add from \"../../icons/add.png\";\nimport { get_all_post, get_all_post_by_uid } from \"../../Firebase/getPosts\";\nimport { get_location } from \"../../utils/getLocation\";\nimport { withAuthentication } from \"../../Session\";\nimport ImageContainer from \"../../ImageContainer\";\nimport NavBar1 from \"../NavBar1\";\nimport { likes } from \"../../Firebase/upload\"; // let data = [\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/dKbkpPXKfvZzWCM.png',\n//         title: 'Meet hotel',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:1,\n//         comments:[],\n//         location:''\n//     },\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/XmwCzSeJiqpkuMB.png',\n//         title: 'McDonald\\'s invites you',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:2,\n//         comments:[],\n//         location:'New Zealand'\n//     },\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/hfVtzEhPzTUewPm.png',\n//         title: 'Eat the week',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:3,\n//         comments:[],\n//         location:''\n//     },\n// ];\n\nlet pageIndex = 0;\n\nclass PostPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.genData = (pIndex = 0) => {\n      const dataBlob = {};\n\n      for (let i = 0; i < this.state.data.length; i++) {\n        const ii = pIndex * this.state.data.length + i;\n        dataBlob[\"\".concat(ii)] = \"row - \".concat(ii);\n      }\n\n      return dataBlob;\n    };\n\n    this.renderItems = () => {\n      this.setState({\n        isLoading: true\n      });\n      get_location(location => {\n        const callback = list => {\n          list.sort((a, b) => {\n            return Date.parse(a.time) >= Date.parse(b.time) ? -1 : 1;\n          });\n          let fliter = this.props.firebase.functions.httpsCallable(\"fliter\"); //console.log(this.state.location)\n          // console.log(list[1])\n\n          fliter([list, this.state.distance, location]).then(result => {\n            // Read result of the Cloud Function.\n            result.data.sort((a, b) => {\n              console.log(a);\n              console.log(b);\n              return Date.parse(a.time) >= Date.parse(b.time) ? -1 : 1;\n            });\n            console.log(result.data);\n            this.setState({\n              data: result.data,\n              isLoading: false\n            });\n          }).catch(function (error) {\n            // Getting the Error details.\n            var code = error.code;\n            var message = error.message;\n            var details = error.details;\n            console.log(\"filtererr\" + code);\n            console.log(message);\n            console.log(details);\n          });\n          this.setState({\n            data: list\n          });\n        };\n\n        this.setState({\n          location: location\n        }, () => get_all_post(this.props.firebase, callback));\n      });\n    };\n\n    this.check = () => {\n      this.renderItems();\n    };\n\n    this.onClickComment = id => {\n      this.props.history.push(\"/home/comments/\".concat(id));\n    };\n\n    this.clickImg = file => {\n      this.setState({\n        isImgClick: true,\n        currentImg: file.url\n      });\n    };\n\n    this.picClose = () => {\n      console.log(\"picCLose\");\n      this.setState({\n        isImgClick: false\n      });\n    };\n\n    this.likes = postId => {\n      likes(this.props.firebase, this.props.firebase.auth.currentUser.uid, postId).then(result => {\n        console.log(result, postId);\n        this.renderItems();\n      }).catch(err => {\n        console.log(err.toString());\n      });\n    };\n\n    this.slider = e => {\n      //  console.log(e)\n      this.setState({\n        distance: e\n      });\n    };\n\n    this.a = time => {\n      let date = new Date(time);\n      return date.toLocaleString();\n    };\n\n    const getSectionData = (dataBlob, sectionID) => dataBlob[sectionID];\n\n    const getRowData = (dataBlob, sectionID, rowID) => dataBlob[rowID];\n\n    const dataSource = new _ListView.DataSource({\n      getRowData,\n      getSectionHeaderData: getSectionData,\n      rowHasChanged: (row1, row2) => row1 !== row2,\n      sectionHeaderHasChanged: (s1, s2) => s1 !== s2\n    });\n    this.state = {\n      dataSource,\n      isLoading: true,\n      height: document.documentElement.clientHeight,\n      distance: 1000,\n      currentImg: '',\n      isImgClick: false,\n      hasMore: false,\n      data: [],\n      ads: ['1', '2', '3'],\n      imgHeight: 176\n    };\n  }\n\n  componentDidMount() {\n    this.renderItems();\n    setTimeout(() => {\n      this.setState({\n        ads: [{\n          key: 'AiyWuByWklrrUDlFignR',\n          url: 'https://firebasestorage.googleapis.com/v0/b/my-project-1571785426296.appspot.com/o/images%2Fy9uUJHoPKJWXxdSBJpsHazKytPJ3_post_34_0.jpg?alt=media&token=ada06999-bcef-438c-8865-3923ef2e38c7'\n        }, {\n          key: 'TekJlZRVCjLFexlOCuWn',\n          url: \"https://firebasestorage.googleapis.com/v0/b/my-project-1571785426296.appspot.com/o/images%2Fy9uUJHoPKJWXxdSBJpsHazKytPJ3_post_36_0.jpg?alt=media&token=c70a463a-5cbb-4c34-a900-2b4cdcd1db1a\"\n        }, {\n          key: 'IJOtIlfsYdTyaDTRVrLI',\n          url: 'https://firebasestorage.googleapis.com/v0/b/my-project-1571785426296.appspot.com/o/images%2Fy9uUJHoPKJWXxdSBJpsHazKytPJ3_post_35_0.jpg?alt=media&token=981f3a4c-7fbe-4055-80f0-c70728ca0674'\n        }]\n      });\n    }, 100); //console.log(a)\n    // console.log(this.props.firebase.db.collection(\"posts\").get())\n    // you can scroll to the specified position\n    // setTimeout(() => this.lv.scrollTo(0, 120), 800);\n    // simulate initial Ajax\n  }\n\n  render() {\n    if (this.state.isLoading) {\n      _Toast.loading('Loading...', 0.5, () => {\n        console.log('Load complete !!!');\n      });\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }, this.state.isImgClick && React.createElement(ImageContainer, {\n      currentImg: this.state.currentImg,\n      picClose: this.picClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }), React.createElement(NavBar1, {\n      history: this.props.history,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }), React.createElement(_Flex, {\n      style: {\n        background: \"white\",\n        height: \"8vh\",\n        position: 'fixed',\n        width: \"100%\",\n        top: \"3vh\",\n        zIndex: 1\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, React.createElement(_Flex.Item, {\n      style: {\n        flex: '8'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, React.createElement(_Slider, {\n      style: {\n        marginLeft: \"10px\",\n        marginTop: '3vh'\n      },\n      defaultValue: this.state.distance * 1,\n      min: 0,\n      max: 30000,\n      step: 100,\n      value: this.state.distance,\n      onChange: e => this.slider(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    })), React.createElement(_Flex.Item, {\n      style: {\n        flex: '3.5',\n        marginTop: '3vh',\n        marginRight: '-1vw',\n        fontSize: \"20px\",\n        background: 'rgba(0,0,0,0)'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269\n      },\n      __self: this\n    }, React.createElement(_InputItem, {\n      type: \"number\",\n      onChange: e => {\n        this.setState({\n          distance: e\n        });\n      },\n      value: this.state.distance,\n      extra: \"m\",\n      style: {\n        background: '#f7f7f7'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    })), React.createElement(_Flex.Item, {\n      style: {\n        flex: '1'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      onClick: this.check,\n      size: \"small\",\n      style: {\n        borderRadius: '100%',\n        background: \"#fbfbfb\",\n        marginTop: '3vh',\n        textAlign: 'center',\n        width: '30px',\n        fontSize: \"4vh\"\n      },\n      type: 'check',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }, React.createElement(_WingBlank, {\n      style: {\n        marginTop: '10vh'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, React.createElement(_Carousel, {\n      autoplay: true,\n      infinite: true,\n      beforeChange: (from, to) => console.log(\"slide from \".concat(from, \" to \").concat(to)),\n      afterChange: index => console.log('slide to', index),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }, this.state.ads.map(val => React.createElement(\"a\", {\n      key: val.key,\n      href: \"http://www.uci.edu\",\n      style: {\n        display: 'inline-block',\n        width: '100%',\n        height: this.state.imgHeight\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: val.url,\n      alt: \"\",\n      style: {\n        width: '70%',\n        verticalAlign: 'top'\n      },\n      onLoad: () => {\n        // fire window resize event to change height\n        window.dispatchEvent(new Event('resize'));\n        this.setState({\n          imgHeight: 'auto'\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    }))))), this.state.data.map((obj, index) => {\n      return React.createElement(\"div\", {\n        key: index,\n        style: {\n          padding: '0 15px',\n          marginBottom: '10px',\n          background: 'white'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, index == 0 ? React.createElement(\"div\", {\n        style: {\n          height: '11vh'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      }) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      })\n      /*show the 1st post completely*/\n      , React.createElement(\"div\", {\n        style: {\n          lineHeight: '40px',\n          color: '#888',\n          fontSize: 15,\n          borderBottom: '1px solid #F6F6F6',\n          background: '#ededed'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }, obj.place ? React.createElement(\"img\", {\n        style: {\n          width: \"5vw\"\n        },\n        src: \"https://image.flaticon.com/icons/png/128/149/149060.png\",\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329\n        },\n        __self: this\n      }) : \"\", obj.place), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331\n        },\n        __self: this\n      }, React.createElement(_Flex, {\n        style: {\n          padding: '15px 0'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        style: {\n          height: '64px',\n          marginRight: '15px'\n        },\n        src: obj.userAvatar,\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 333\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          lineHeight: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        style: {\n          fontSize: '20px',\n          color: '#4e77a1',\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336\n        },\n        __self: this\n      }, obj.username)), React.createElement(\"div\", {\n        style: {\n          color: '#5396a5',\n          fontSize: '18px',\n          marginBottom: '8px',\n          marginTop: '5px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 337\n        },\n        __self: this\n      }, this.a(obj.time)))), React.createElement(_Flex, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 340\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginBottom: '8px',\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 341\n        },\n        __self: this\n      }, obj.content)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343\n        },\n        __self: this\n      }, React.createElement(_ImagePicker, {\n        files: obj.pictures_url.map(item => {\n          return {\n            url: item\n          };\n        }),\n        onChange: this.onChange,\n        onImageClick: (index, fs) => {\n          this.clickImg(fs[index]);\n        },\n        selectable: false,\n        disableDelete: true,\n        length: 3,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344\n        },\n        __self: this\n      }))), React.createElement(_Flex, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363\n        },\n        __self: this\n      }, React.createElement(_Flex.Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      }, React.createElement(_Button, {\n        size: \"small\",\n        activeStyle: {\n          background: '#4e77a1'\n        },\n        style: {\n          background: '#5396a5',\n          color: \"#ecfcee\",\n          fontWeight: 'bold'\n        },\n        onClick: () => this.onClickComment(obj.postId),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      }, \"Comment(\", obj.comments.length, \")\")), React.createElement(_Flex.Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 365\n        },\n        __self: this\n      }, React.createElement(_Button, {\n        size: \"small\",\n        activeStyle: {\n          background: '#4e77a1'\n        },\n        style: {\n          background: '#5396a5',\n          color: \"#ecfcee\",\n          fontWeight: 'bold'\n        },\n        onClick: () => this.likes(obj.postId),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 365\n        },\n        __self: this\n      }, \"Likes \", obj.likes !== 0 ? '(' + obj.likes.length + ')' : \"\"))));\n    })));\n  }\n\n}\n\nexport default withAuthentication(PostPage);","map":{"version":3,"sources":["/Users/jiadaye/workspace/cirko/src/components/Home/PostPage/index.js"],"names":["React","ROUTES","add","get_all_post","get_all_post_by_uid","get_location","withAuthentication","ImageContainer","NavBar1","likes","pageIndex","PostPage","Component","constructor","props","genData","pIndex","dataBlob","i","state","data","length","ii","renderItems","setState","isLoading","location","callback","list","sort","a","b","Date","parse","time","fliter","firebase","functions","httpsCallable","distance","then","result","console","log","catch","error","code","message","details","check","onClickComment","id","history","push","clickImg","file","isImgClick","currentImg","url","picClose","postId","auth","currentUser","uid","err","toString","slider","e","date","toLocaleString","getSectionData","sectionID","getRowData","rowID","dataSource","DataSource","getSectionHeaderData","rowHasChanged","row1","row2","sectionHeaderHasChanged","s1","s2","height","document","documentElement","clientHeight","hasMore","ads","imgHeight","componentDidMount","setTimeout","key","render","loading","background","position","width","top","zIndex","flex","marginLeft","marginTop","marginRight","fontSize","borderRadius","textAlign","from","to","index","map","val","display","verticalAlign","window","dispatchEvent","Event","obj","padding","marginBottom","lineHeight","color","borderBottom","place","userAvatar","fontWeight","username","content","pictures_url","item","onChange","fs","comments"],"mappings":"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","sourcesContent":["/* eslint no-dupe-keys: 0 */\nimport {\n    ListView,\n    NavBar,\n    Button,\n    Flex,\n    Toast,\n    Slider,\n    Icon,\n    ImagePicker,\n    InputItem,\n    List,\n    Switch,\n    WingBlank, Carousel\n} from 'antd-mobile';\nimport React from 'react'\n\n\nimport * as ROUTES from \"../../../constants/routes\";\nimport add from \"../../icons/add.png\";\nimport { get_all_post, get_all_post_by_uid } from \"../../Firebase/getPosts\";\nimport { get_location } from \"../../utils/getLocation\";\nimport { withAuthentication } from \"../../Session\";\nimport ImageContainer from \"../../ImageContainer\";\nimport NavBar1 from \"../NavBar1\";\nimport { likes } from \"../../Firebase/upload\";\n// let data = [\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/dKbkpPXKfvZzWCM.png',\n//         title: 'Meet hotel',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:1,\n//         comments:[],\n//         location:''\n//     },\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/XmwCzSeJiqpkuMB.png',\n//         title: 'McDonald\\'s invites you',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:2,\n//         comments:[],\n//         location:'New Zealand'\n//     },\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/hfVtzEhPzTUewPm.png',\n//         title: 'Eat the week',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:3,\n//         comments:[],\n//         location:''\n//     },\n// ];\n\nlet pageIndex = 0;\n\n\n\n\nclass PostPage extends React.Component {\n\n\n    constructor(props) {\n        super(props);\n        const getSectionData = (dataBlob, sectionID) => dataBlob[sectionID];\n        const getRowData = (dataBlob, sectionID, rowID) => dataBlob[rowID];\n\n        const dataSource = new ListView.DataSource({\n            getRowData,\n            getSectionHeaderData: getSectionData,\n            rowHasChanged: (row1, row2) => row1 !== row2,\n            sectionHeaderHasChanged: (s1, s2) => s1 !== s2,\n        });\n\n        this.state = {\n            dataSource,\n            isLoading: true,\n            height: document.documentElement.clientHeight ,\n            distance:1000,\n            currentImg:'',\n            isImgClick:false,\n            hasMore:false,\n            data:[],\n            ads: ['1', '2', '3'],\n            imgHeight: 176,\n        };\n    }\n    genData =(pIndex = 0)=> {\n        const dataBlob = {};\n        for (let i = 0; i < this.state.data.length; i++) {\n            const ii = (pIndex *  this.state.data.length) + i;\n            dataBlob[`${ii}`] = `row - ${ii}`;\n        }\n        return dataBlob;\n    }\n    renderItems = ()=>{\n        this.setState({\n            isLoading:true\n        })\n        get_location((location)=>{\n\n\n            const callback = (list)=>{\n\n                list.sort((a,b)=>{\n\n                    return Date.parse(a.time)>=Date.parse(b.time)?-1:1})\n                let fliter = this.props.firebase.functions.httpsCallable(\"fliter\");\n\n                //console.log(this.state.location)\n               // console.log(list[1])\n                fliter([list,this.state.distance,location]).then( (result)=> {\n                    // Read result of the Cloud Function.\n\n                    result.data.sort((a,b)=>{\n                        console.log(a)\n                        console.log(b)\n                        return Date.parse(a.time)>=Date.parse(b.time)?-1:1})\n                    console.log(result.data)\n                  this.setState({\n                          data:result.data,\n                            isLoading:false\n                  }\n\n                  )\n                }).catch(function (error) {\n                    // Getting the Error details.\n                    var code = error.code;\n                    var message = error.message;\n                    var details = error.details;\n                    console.log(\"filtererr\"+code);\n                    console.log(message);\n                    console.log(details);\n\n                });\n\n\n\n                this.setState({\n                    data:list\n                })\n\n            }\n\n\n\n\n\n            this.setState({\n                location:location\n            }, ()=> get_all_post(this.props.firebase,callback))\n\n\n\n\n\n        })\n    }\n\n    componentDidMount() {\n\n        this.renderItems();\n\n        setTimeout(() => {\n            this.setState({\n                ads: [{key:'AiyWuByWklrrUDlFignR', url:'https://firebasestorage.googleapis.com/v0/b/my-project-1571785426296.appspot.com/o/images%2Fy9uUJHoPKJWXxdSBJpsHazKytPJ3_post_34_0.jpg?alt=media&token=ada06999-bcef-438c-8865-3923ef2e38c7'},\n                    {key:'TekJlZRVCjLFexlOCuWn',url:\"https://firebasestorage.googleapis.com/v0/b/my-project-1571785426296.appspot.com/o/images%2Fy9uUJHoPKJWXxdSBJpsHazKytPJ3_post_36_0.jpg?alt=media&token=c70a463a-5cbb-4c34-a900-2b4cdcd1db1a\"},\n                    {key:'IJOtIlfsYdTyaDTRVrLI',url:'https://firebasestorage.googleapis.com/v0/b/my-project-1571785426296.appspot.com/o/images%2Fy9uUJHoPKJWXxdSBJpsHazKytPJ3_post_35_0.jpg?alt=media&token=981f3a4c-7fbe-4055-80f0-c70728ca0674'}],\n\n            });\n\n\n        }, 100);\n\n        //console.log(a)\n        \n\n       // console.log(this.props.firebase.db.collection(\"posts\").get())\n        // you can scroll to the specified position\n        // setTimeout(() => this.lv.scrollTo(0, 120), 800);\n\n        // simulate initial Ajax\n\n    }\n\n    check = ()=>{\n        this.renderItems();\n\n}\n\n\n\nonClickComment =(id)=>{\n\n    this.props.history.push(`/home/comments/${id}`)\n}\n\nclickImg = (file)=>{\n\nthis.setState({\n    isImgClick:true,\n    currentImg:file.url\n})\n}\npicClose=()=>{\n        console.log(\"picCLose\")\n        this.setState({\n            isImgClick:false\n        })\n}\n\nlikes = (postId)=>{\n\n    likes(this.props.firebase,this.props.firebase.auth.currentUser.uid,postId).then((result)=>{\n        console.log(result,postId);\n        this.renderItems()\n\n    }).catch(err=>{\n        console.log(err.toString())\n    });\n\n}\n\n\n    slider =(e)=>{\n        //  console.log(e)\n        this.setState({\n            distance:e\n        })\n    }\n    a = (time)=>{\n        let date = new Date(time);\n        return date.toLocaleString();\n    };\n\n    render() {\n        if(this.state.isLoading){\n            Toast.loading('Loading...', 0.5, () => {\n                console.log('Load complete !!!');\n            });\n        }\n\n\n\n\n        return (\n            <div >\n                {this.state.isImgClick&&<ImageContainer currentImg={this.state.currentImg} picClose={this.picClose}/>}\n               <NavBar1 history={this.props.history}/>\n\n                <Flex style={{ background: \"white\",height:\"8vh\",position:'fixed',width:\"100%\", top:\"3vh\",zIndex:1}}>\n                    <Flex.Item style={{flex:'8'}}>\n                        <Slider\n                        style={{marginLeft:\"10px\",marginTop:'3vh'}}\n                    defaultValue={this.state.distance*1}\n                    min={0}\n                    max={30000}\n                    step={100}\n                    value={this.state.distance}\n                    onChange={(e)=>this.slider(e)}\n                />\n\n                </Flex.Item>\n                    <Flex.Item style={{flex:'3.5',marginTop:'3vh',marginRight:'-1vw',fontSize:\"20px\", background:'rgba(0,0,0,0)'} }>\n                        <InputItem\n                            type=\"number\"\n                            onChange={(e)=>{this.setState({distance:e})}}\n                            value={this.state.distance}\n                            extra=\"m\"\n                            style={{background:'#f7f7f7'}}\n                        />\n                    </Flex.Item>\n                    <Flex.Item style={{flex:'1'}} >\n                       <Icon onClick={this.check} size='small' style={{borderRadius:'100%',background:\"#fbfbfb\",marginTop:'3vh', textAlign:'center',width:'30px' ,fontSize:\"4vh\"} }type={'check'} />\n                    </Flex.Item>\n                </Flex>\n\n\n          <div >\n              <WingBlank style={{marginTop:'10vh'}}>\n                  <Carousel\n                      autoplay={true}\n                      infinite\n                      beforeChange={(from, to) => console.log(`slide from ${from} to ${to}`)}\n                      afterChange={index => console.log('slide to', index)}\n                  >\n                      {this.state.ads.map(val => (\n                          <a\n                              key={val.key}\n                              href=\"http://www.uci.edu\"\n                              style={{ display: 'inline-block', width: '100%', height: this.state.imgHeight }}\n                          >\n                              <img\n                                  src={val.url}\n                                  alt=\"\"\n                                  style={{ width: '70%', verticalAlign: 'top' }}\n                                  onLoad={() => {\n                                      // fire window resize event to change height\n                                      window.dispatchEvent(new Event('resize'));\n                                      this.setState({ imgHeight: 'auto' });\n                                  }}\n                              />\n                          </a>\n                      ))}\n                  </Carousel>\n              </WingBlank>\n\n              {\n\n                  this.state.data.map((obj,index)=>{\n                      return(\n                          <div key={index} style={{ padding: '0 15px', marginBottom:'10px', background:'white' }}>\n                              {index==0?  <div style={{height:'11vh'}}></div>:<div/> /*show the 1st post completely*/}\n                              <div\n                                  style={{\n                                      lineHeight: '40px',\n                                      color: '#888',\n                                      fontSize: 15,\n                                      borderBottom: '1px solid #F6F6F6',\n                                      background:'#ededed',\n\n\n                                  }}\n                              >{obj.place?<img style={{width:\"5vw\"}} src=\"https://image.flaticon.com/icons/png/128/149/149060.png\" alt=\"\"/>:\"\"}{obj.place}</div>\n\n                              <div>\n                                  <Flex style={{  padding: '15px 0' }}>\n                                      <img style={{ height: '64px', marginRight: '15px' }} src={obj.userAvatar} alt=\"\" />\n                                      <div style={{ lineHeight: 1 }}>\n\n                                          <div><span style={{  fontSize: '20px',color: '#4e77a1',fontWeight: 'bold' }}>{obj.username}</span></div>\n                                          <div style={{ color: '#5396a5',fontSize: '18px',marginBottom: '8px',marginTop: '5px'  }}>{this.a(obj.time)}</div>\n                                      </div>\n                                  </Flex>\n                                  <Flex>\n                                      <div style={{ marginBottom: '8px', fontWeight: 'bold' }}>{obj.content}</div>\n                                  </Flex>\n                                  <div>\n                                      <ImagePicker\n                                          files={obj.pictures_url.map((item)=>{\n                                              return {url:item}\n                                          })}\n\n                                          onChange={this.onChange}\n                                          onImageClick={(index, fs) => {\n                                              this.clickImg(fs[index]);\n                                          }}\n                                          selectable={false}\n                                          disableDelete={true}\n                                          length={3}\n\n\n                                      />\n\n                                  </div>\n                              </div>\n\n                              <Flex>\n                                  <Flex.Item><Button size='small' activeStyle={{background:'#4e77a1'}} style={{background:'#5396a5' ,color:\"#ecfcee\",fontWeight: 'bold'}} onClick={()=> this.onClickComment(obj.postId)}>Comment({obj.comments.length})</Button></Flex.Item>\n                                  <Flex.Item><Button size='small' activeStyle={{background:'#4e77a1'}} style={{background:'#5396a5',color:\"#ecfcee\",fontWeight: 'bold'}} onClick={()=>this.likes(obj.postId)}>Likes {obj.likes!==0?'('+obj.likes.length+')':\"\"}</Button></Flex.Item>\n                              </Flex>\n                          </div>\n                      )\n                  })\n              }\n\n          </div>\n\n            </div>\n        );\n    }\n}\n\nexport default withAuthentication(PostPage);\n\n"]},"metadata":{},"sourceType":"module"}