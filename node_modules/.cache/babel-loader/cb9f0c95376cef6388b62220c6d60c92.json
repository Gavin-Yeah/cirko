{"ast":null,"code":"import \"antd-mobile/lib/icon/style\";\nimport _Icon from \"antd-mobile/lib/icon\";\nimport \"antd-mobile/lib/input-item/style\";\nimport _InputItem from \"antd-mobile/lib/input-item\";\nimport \"antd-mobile/lib/slider/style\";\nimport _Slider from \"antd-mobile/lib/slider\";\nimport \"antd-mobile/lib/button/style\";\nimport _Button from \"antd-mobile/lib/button\";\nimport \"antd-mobile/lib/image-picker/style\";\nimport _ImagePicker from \"antd-mobile/lib/image-picker\";\nimport \"antd-mobile/lib/flex/style\";\nimport _Flex from \"antd-mobile/lib/flex\";\nimport \"antd-mobile/lib/toast/style\";\nimport _Toast from \"antd-mobile/lib/toast\";\nimport \"antd-mobile/lib/list-view/style\";\nimport _ListView from \"antd-mobile/lib/list-view\";\nimport _defineProperty from \"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/jiadaye/workspace/cirko/src/components/Home/PostPage/index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport * as ROUTES from \"../../../constants/routes\";\nimport add from \"../../icons/add.png\";\nimport { get_all_post, get_all_post_by_uid } from \"../../Firebase/getPosts\";\nimport { get_location } from \"../../utils/getLocation\";\nimport { withAuthentication } from \"../../Session\";\nimport ImageContainer from \"../../ImageContainer\";\nimport NavBar1 from \"../NavBar1\"; // let data = [\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/dKbkpPXKfvZzWCM.png',\n//         title: 'Meet hotel',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:1,\n//         comments:[],\n//         location:''\n//     },\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/XmwCzSeJiqpkuMB.png',\n//         title: 'McDonald\\'s invites you',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:2,\n//         comments:[],\n//         location:'New Zealand'\n//     },\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/hfVtzEhPzTUewPm.png',\n//         title: 'Eat the week',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:3,\n//         comments:[],\n//         location:''\n//     },\n// ];\n\nlet pageIndex = 0;\n\nclass PostPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.genData = (pIndex = 0) => {\n      const dataBlob = {};\n\n      for (let i = 0; i < this.state.data.length; i++) {\n        const ii = pIndex * this.state.data.length + i;\n        dataBlob[\"\".concat(ii)] = \"row - \".concat(ii);\n      }\n\n      return dataBlob;\n    };\n\n    this.renderItems = () => {\n      get_location(location => {\n        const callback = list => {\n          let fliter = this.props.firebase.functions.httpsCallable(\"fliter\");\n          let list_posts = [{\n            username: 'hehe',\n            location: {\n              lat: 33.6429056,\n              lng: -117.84273920000001\n            },\n            content: 'hehe'\n          }, {\n            comments: [],\n            likes: [],\n            username: 'gege',\n            location: {\n              lat: 33.662566399999996,\n              lng: -117.84273920000001\n            },\n            content: \"haha\"\n          }];\n          let user_location = {\n            lat: 33.6429056,\n            lng: -117.84273920000001\n          }; //console.log(this.state.location)\n          // console.log(list[1])\n\n          fliter([list, this.state.distance, location]).then(result => {\n            // Read result of the Cloud Function.\n            console.log(result.data);\n            this.setState({\n              data: result.data\n            });\n          }).catch(function (error) {\n            // Getting the Error details.\n            var code = error.code;\n            var message = error.message;\n            var details = error.details;\n            console.log(\"filtererr\" + code);\n            console.log(message);\n            console.log(details);\n          });\n          this.setState({\n            data: list\n          });\n          setTimeout(() => {\n            this.rData = this.genData();\n            this.setState({\n              dataSource: this.state.dataSource.cloneWithRows(this.rData),\n              isLoading: false\n            });\n          }, 1000);\n        };\n\n        this.setState({\n          location: location\n        }, () => get_all_post(this.props.firebase, callback));\n      });\n    };\n\n    this.check = () => {\n      this.renderItems();\n    };\n\n    this.onEndReached = event => {\n      // load new data\n      // hasMore: from backend data, indicates whether it is the last page, here is false\n      if (this.state.isLoading && !this.state.hasMore) {\n        return;\n      }\n\n      console.log('reach end', event);\n      this.setState({\n        isLoading: true\n      });\n      setTimeout(() => {\n        this.rData = _objectSpread({}, this.rData, {}, this.genData(++pageIndex));\n        this.setState({\n          dataSource: this.state.dataSource.cloneWithRows(this.rData),\n          isLoading: false\n        });\n      }, 1000);\n    };\n\n    this.onClickComment = id => {\n      this.props.history.push(\"/home/comments/\".concat(id));\n    };\n\n    this.clickImg = file => {\n      this.setState({\n        isImgClick: true,\n        currentImg: file.url\n      });\n    };\n\n    this.picClose = () => {\n      console.log(\"picCLose\");\n      this.setState({\n        isImgClick: false\n      });\n    };\n\n    this.slider = e => {\n      console.log(e);\n      this.setState({\n        distance: e\n      });\n    };\n\n    this.likes = () => {};\n\n    const getSectionData = (dataBlob, sectionID) => dataBlob[sectionID];\n\n    const getRowData = (dataBlob, sectionID, rowID) => dataBlob[rowID];\n\n    const dataSource = new _ListView.DataSource({\n      getRowData,\n      getSectionHeaderData: getSectionData,\n      rowHasChanged: (row1, row2) => row1 !== row2,\n      sectionHeaderHasChanged: (s1, s2) => s1 !== s2\n    });\n    this.state = {\n      dataSource,\n      isLoading: true,\n      height: document.documentElement.clientHeight,\n      distance: 1000,\n      currentImg: '',\n      isImgClick: false,\n      hasMore: false,\n      data: [{\n        pictures_url: [],\n        place: '',\n        time: '11/12/2019',\n        likes: 5,\n        id: 3,\n        comments: [],\n        location: ''\n      }]\n    };\n  }\n\n  componentDidMount() {\n    this.renderItems(); //console.log(a)\n    // console.log(this.props.firebase.db.collection(\"posts\").get())\n    // you can scroll to the specified position\n    // setTimeout(() => this.lv.scrollTo(0, 120), 800);\n    // simulate initial Ajax\n  }\n\n  render() {\n    if (this.state.isLoading) {\n      _Toast.loading('Loading...', 0.5, () => {\n        console.log('Load complete !!!');\n      });\n    }\n\n    const separator = (sectionID, rowID) => React.createElement(\"div\", {\n      key: \"\".concat(sectionID, \"-\").concat(rowID),\n      style: {\n        backgroundColor: '#F5F5F9',\n        height: 8,\n        borderTop: '1px solid #ECECED',\n        borderBottom: '1px solid #ECECED'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    });\n\n    let index = this.state.data.length - 1;\n\n    const row = (rowData, sectionID, rowID) => {\n      if (index < 0) {\n        index = this.state.data.length - 1;\n      }\n\n      const obj = this.state.data[index--];\n      return React.createElement(\"div\", {\n        key: rowID,\n        style: {\n          padding: '0 15px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }, rowID == 0 ? React.createElement(\"div\", {\n        style: {\n          height: '10vh',\n          background: 'white'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      })\n      /*show the 1st post completely*/\n      , React.createElement(\"div\", {\n        style: {\n          lineHeight: '40px',\n          color: '#888',\n          fontSize: 15,\n          borderBottom: '1px solid #F6F6F6',\n          background: 'white'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, obj.place), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273\n        },\n        __self: this\n      }, React.createElement(_Flex, {\n        style: {\n          padding: '15px 0'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        style: {\n          height: '64px',\n          marginRight: '15px'\n        },\n        src: obj.userAvatar,\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          lineHeight: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        style: {\n          fontSize: '20px',\n          color: '#4e77a1',\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278\n        },\n        __self: this\n      }, obj.username)), React.createElement(\"div\", {\n        style: {\n          color: '#5396a5',\n          fontSize: '18px',\n          marginBottom: '8px',\n          marginTop: '5px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279\n        },\n        __self: this\n      }, obj.time))), React.createElement(_Flex, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginBottom: '8px',\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283\n        },\n        __self: this\n      }, obj.content)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285\n        },\n        __self: this\n      }, React.createElement(_ImagePicker, {\n        files: obj.pictures_url.map(item => {\n          return {\n            url: item\n          };\n        }),\n        onChange: this.onChange,\n        onImageClick: (index, fs) => {\n          this.clickImg(fs[index]);\n        },\n        selectable: false,\n        disableDelete: true,\n        length: 3,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      }))), React.createElement(_Flex, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      }, React.createElement(_Flex.Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305\n        },\n        __self: this\n      }, React.createElement(_Button, {\n        size: \"small\",\n        style: {\n          background: '#5396a5',\n          color: \"#ecfcee\",\n          fontWeight: 'bold'\n        },\n        onClick: () => this.onClickComment(obj.postId),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305\n        },\n        __self: this\n      }, \"Comment\")), React.createElement(_Flex.Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 306\n        },\n        __self: this\n      }, React.createElement(_Button, {\n        size: \"small\",\n        style: {\n          background: '#5396a5',\n          color: \"#ecfcee\",\n          fontWeight: 'bold'\n        },\n        onClick: this.likes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 306\n        },\n        __self: this\n      }, \"Likes \", !!!obj.likes ? '(' + obj.likes + ')' : \"\"))));\n    };\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, this.state.isImgClick && React.createElement(ImageContainer, {\n      currentImg: this.state.currentImg,\n      picClose: this.picClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316\n      },\n      __self: this\n    }), React.createElement(NavBar1, {\n      history: this.props.history,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    }), React.createElement(_Flex, {\n      style: {\n        background: \"white\",\n        height: \"8vh\",\n        position: 'fixed',\n        width: \"100%\",\n        top: \"3vh\",\n        zIndex: 1\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, React.createElement(_Flex.Item, {\n      style: {\n        flex: '8'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320\n      },\n      __self: this\n    }, \" \", React.createElement(_Slider, {\n      style: {\n        marginLeft: \"10px\",\n        marginTop: '3vh'\n      },\n      defaultValue: this.state.distance,\n      min: 0,\n      max: 30000,\n      step: 100,\n      value: this.state.distance,\n      onChange: e => this.slider(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320\n      },\n      __self: this\n    })), React.createElement(_Flex.Item, {\n      style: {\n        flex: '3',\n        marginTop: '3vh',\n        background: 'black',\n        fontSize: \"20px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332\n      },\n      __self: this\n    }, React.createElement(_InputItem, {\n      type: \"number\",\n      style: {\n        background: 'black'\n      },\n      onChange: e => {\n        this.setState({\n          distance: e\n        });\n      },\n      value: this.state.distance,\n      extra: \"m\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    })), React.createElement(_Flex.Item, {\n      style: {\n        flex: '1'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      onClick: this.check,\n      size: \"small\",\n      style: {\n        borderRadius: '100%',\n        background: \"lightgrey\",\n        marginTop: '3vh',\n        textAlign: 'center',\n        width: '30px',\n        fontSize: \"4vh\"\n      },\n      type: 'check',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 345\n      },\n      __self: this\n    }, this.state.data.map((obj, index) => {\n      return React.createElement(\"div\", {\n        key: index,\n        style: {\n          padding: '0 15px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 349\n        },\n        __self: this\n      }, index == 0 ? React.createElement(\"div\", {\n        style: {\n          height: '10vh',\n          background: 'white'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350\n        },\n        __self: this\n      }) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350\n        },\n        __self: this\n      })\n      /*show the 1st post completely*/\n      , React.createElement(\"div\", {\n        style: {\n          lineHeight: '40px',\n          color: '#888',\n          fontSize: 15,\n          borderBottom: '1px solid #F6F6F6'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 351\n        },\n        __self: this\n      }, obj.place), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 360\n        },\n        __self: this\n      }, React.createElement(_Flex, {\n        style: {\n          padding: '15px 0'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 361\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        style: {\n          height: '64px',\n          marginRight: '15px'\n        },\n        src: obj.userAvatar,\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 362\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          lineHeight: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 365\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        style: {\n          fontSize: '20px',\n          color: '#4e77a1',\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 365\n        },\n        __self: this\n      }, obj.username)), React.createElement(\"div\", {\n        style: {\n          color: '#5396a5',\n          fontSize: '18px',\n          marginBottom: '8px',\n          marginTop: '5px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 366\n        },\n        __self: this\n      }, obj.time))), React.createElement(_Flex, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginBottom: '8px',\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 370\n        },\n        __self: this\n      }, obj.content)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 372\n        },\n        __self: this\n      }, React.createElement(_ImagePicker, {\n        files: obj.pictures_url.map(item => {\n          return {\n            url: item\n          };\n        }),\n        onChange: this.onChange,\n        onImageClick: (index, fs) => {\n          this.clickImg(fs[index]);\n        },\n        selectable: false,\n        disableDelete: true,\n        length: 3,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 373\n        },\n        __self: this\n      }))), React.createElement(_Flex, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 391\n        },\n        __self: this\n      }, React.createElement(_Flex.Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 392\n        },\n        __self: this\n      }, React.createElement(_Button, {\n        size: \"small\",\n        style: {\n          background: '#5396a5',\n          color: \"#ecfcee\",\n          fontWeight: 'bold'\n        },\n        onClick: () => this.onClickComment(obj.postId),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 392\n        },\n        __self: this\n      }, \"Comment\")), React.createElement(_Flex.Item, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 393\n        },\n        __self: this\n      }, React.createElement(_Button, {\n        size: \"small\",\n        style: {\n          background: '#5396a5',\n          color: \"#ecfcee\",\n          fontWeight: 'bold'\n        },\n        onClick: this.likes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 393\n        },\n        __self: this\n      }, \"Likes \", !!!obj.likes ? '(' + obj.likes.length + ')' : \"\"))));\n    })));\n  }\n\n}\n\nexport default withAuthentication(PostPage);","map":{"version":3,"sources":["/Users/jiadaye/workspace/cirko/src/components/Home/PostPage/index.js"],"names":["React","ROUTES","add","get_all_post","get_all_post_by_uid","get_location","withAuthentication","ImageContainer","NavBar1","pageIndex","PostPage","Component","constructor","props","genData","pIndex","dataBlob","i","state","data","length","ii","renderItems","location","callback","list","fliter","firebase","functions","httpsCallable","list_posts","username","lat","lng","content","comments","likes","user_location","distance","then","result","console","log","setState","catch","error","code","message","details","setTimeout","rData","dataSource","cloneWithRows","isLoading","check","onEndReached","event","hasMore","onClickComment","id","history","push","clickImg","file","isImgClick","currentImg","url","picClose","slider","e","getSectionData","sectionID","getRowData","rowID","DataSource","getSectionHeaderData","rowHasChanged","row1","row2","sectionHeaderHasChanged","s1","s2","height","document","documentElement","clientHeight","pictures_url","place","time","componentDidMount","render","loading","separator","backgroundColor","borderTop","borderBottom","index","row","rowData","obj","padding","background","lineHeight","color","fontSize","marginRight","userAvatar","fontWeight","marginBottom","marginTop","map","item","onChange","fs","postId","position","width","top","zIndex","flex","marginLeft","borderRadius","textAlign"],"mappings":"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","sourcesContent":["/* eslint no-dupe-keys: 0 */\nimport { ListView, NavBar, Button, Flex, Toast, Slider, Icon, ImagePicker, InputItem } from 'antd-mobile';\nimport React from 'react'\n\n\nimport * as ROUTES from \"../../../constants/routes\";\nimport add from \"../../icons/add.png\";\nimport { get_all_post, get_all_post_by_uid } from \"../../Firebase/getPosts\";\nimport { get_location } from \"../../utils/getLocation\";\nimport { withAuthentication } from \"../../Session\";\nimport ImageContainer from \"../../ImageContainer\";\nimport NavBar1 from \"../NavBar1\";\n// let data = [\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/dKbkpPXKfvZzWCM.png',\n//         title: 'Meet hotel',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:1,\n//         comments:[],\n//         location:''\n//     },\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/XmwCzSeJiqpkuMB.png',\n//         title: 'McDonald\\'s invites you',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:2,\n//         comments:[],\n//         location:'New Zealand'\n//     },\n//     {\n//         img: 'https://zos.alipayobjects.com/rmsportal/hfVtzEhPzTUewPm.png',\n//         title: 'Eat the week',\n//         des: '不是所有的兼职汪都需要风吹日晒',\n//         time: '11/12/2019',\n//         likes:5,\n//         id:3,\n//         comments:[],\n//         location:''\n//     },\n// ];\n\nlet pageIndex = 0;\n\n\n\n\nclass PostPage extends React.Component {\n\n\n    constructor(props) {\n        super(props);\n        const getSectionData = (dataBlob, sectionID) => dataBlob[sectionID];\n        const getRowData = (dataBlob, sectionID, rowID) => dataBlob[rowID];\n\n        const dataSource = new ListView.DataSource({\n            getRowData,\n            getSectionHeaderData: getSectionData,\n            rowHasChanged: (row1, row2) => row1 !== row2,\n            sectionHeaderHasChanged: (s1, s2) => s1 !== s2,\n        });\n\n        this.state = {\n            dataSource,\n            isLoading: true,\n            height: document.documentElement.clientHeight ,\n            distance:1000,\n            currentImg:'',\n            isImgClick:false,\n            hasMore:false,\n            data:[{\n                pictures_url: [],\n        place:'',\n        time: '11/12/2019',\n        likes:5,\n        id:3,\n        comments:[],\n        location:''\n    }]\n        };\n    }\n    genData =(pIndex = 0)=> {\n        const dataBlob = {};\n        for (let i = 0; i < this.state.data.length; i++) {\n            const ii = (pIndex *  this.state.data.length) + i;\n            dataBlob[`${ii}`] = `row - ${ii}`;\n        }\n        return dataBlob;\n    }\n    renderItems = ()=>{\n        get_location((location)=>{\n\n\n            const callback = (list)=>{\n                let fliter = this.props.firebase.functions.httpsCallable(\"fliter\");\n                let list_posts = [{\n                    username:'hehe',\n                    location: {\n                        lat: 33.6429056,\n                        lng: -117.84273920000001\n                    },\n                    content:'hehe'\n                },\n                    {\n                        comments:[],\n                        likes:[],\n                        username:'gege',\n                        location: {\n                            lat: 33.662566399999996,\n                            lng: -117.84273920000001\n                        },\n                        content: \"haha\"\n                    }];\n                let user_location = {\n                    lat: 33.6429056,\n                    lng: -117.84273920000001\n                };\n                //console.log(this.state.location)\n               // console.log(list[1])\n                fliter([list,this.state.distance,location]).then( (result)=> {\n                    // Read result of the Cloud Function.\n                    console.log(result.data)\n                  this.setState({\n                          data:result.data\n                  }\n\n                  )\n                }).catch(function (error) {\n                    // Getting the Error details.\n                    var code = error.code;\n                    var message = error.message;\n                    var details = error.details;\n                    console.log(\"filtererr\"+code);\n                    console.log(message);\n                    console.log(details);\n\n                });\n\n\n\n                this.setState({\n                    data:list\n                })\n                setTimeout(() => {\n                    this.rData = this.genData();\n                    this.setState({\n                        dataSource: this.state.dataSource.cloneWithRows(this.rData),\n                        isLoading: false,\n                    });\n                }, 1000);\n            }\n\n\n\n\n\n            this.setState({\n                location:location\n            }, ()=> get_all_post(this.props.firebase,callback))\n\n\n\n\n\n        })\n    }\n\n    componentDidMount() {\n\n        this.renderItems();\n\n        //console.log(a)\n        \n\n       // console.log(this.props.firebase.db.collection(\"posts\").get())\n        // you can scroll to the specified position\n        // setTimeout(() => this.lv.scrollTo(0, 120), 800);\n\n        // simulate initial Ajax\n\n    }\n\n    check = ()=>{\n        this.renderItems();\n\n}\n\n    onEndReached = (event) => {\n        // load new data\n        // hasMore: from backend data, indicates whether it is the last page, here is false\n        if (this.state.isLoading && !this.state.hasMore) {\n            return;\n        }\n        console.log('reach end', event);\n        this.setState({ isLoading: true });\n        setTimeout(() => {\n            this.rData = { ...this.rData, ...this.genData(++pageIndex) };\n            this.setState({\n                dataSource: this.state.dataSource.cloneWithRows(this.rData),\n                isLoading: false,\n            });\n        }, 1000);\n    }\n\nonClickComment =(id)=>{\n\n    this.props.history.push(`/home/comments/${id}`)\n}\n\nclickImg = (file)=>{\n\nthis.setState({\n    isImgClick:true,\n    currentImg:file.url\n})\n}\npicClose=()=>{\n        console.log(\"picCLose\")\n        this.setState({\n            isImgClick:false\n        })\n}\n\nslider =(e)=>{\n        console.log(e)\n      this.setState({\n          distance:e\n      })\n}\nlikes = ()=>{\n\n}\n    render() {\n        if(this.state.isLoading){\n            Toast.loading('Loading...', 0.5, () => {\n                console.log('Load complete !!!');\n            });\n        }\n        const separator = (sectionID, rowID) => (\n            <div\n                key={`${sectionID}-${rowID}`}\n                style={{\n                    backgroundColor: '#F5F5F9',\n                    height: 8,\n                    borderTop: '1px solid #ECECED',\n                    borderBottom: '1px solid #ECECED',\n                }}\n            />\n        );\n        let index = this.state.data.length - 1;\n        const row = (rowData, sectionID, rowID) => {\n            if (index < 0) {\n                index = this.state.data.length - 1;\n            }\n            const obj = this.state.data[index--];\n            return (\n\n\n                <div key={rowID} style={{ padding: '0 15px' }}>\n                    {rowID==0?  <div style={{height:'10vh' ,background:'white'}}></div>:<div/> /*show the 1st post completely*/}\n                    <div\n                        style={{\n                            lineHeight: '40px',\n                            color: '#888',\n                            fontSize: 15,\n                            borderBottom: '1px solid #F6F6F6',\n                            background:'white'\n                        }}\n                    >{obj.place}</div>\n                    <div>\n                        <Flex style={{  padding: '15px 0' }}>\n                            <img style={{ height: '64px', marginRight: '15px' }} src={obj.userAvatar} alt=\"\" />\n                            <div style={{ lineHeight: 1 }}>\n\n                                <div><span style={{  fontSize: '20px',color: '#4e77a1',fontWeight: 'bold' }}>{obj.username}</span></div>\n                                <div style={{ color: '#5396a5',fontSize: '18px',marginBottom: '8px',marginTop: '5px'  }}>{obj.time}</div>\n                            </div>\n                        </Flex>\n                        <Flex>\n                            <div style={{ marginBottom: '8px', fontWeight: 'bold' }}>{obj.content}</div>\n                        </Flex>\n                        <div>\n                            <ImagePicker\n                                files={obj.pictures_url.map((item)=>{\n                                    return {url:item}\n                                })}\n\n                                onChange={this.onChange}\n                                onImageClick={(index, fs) => {\n                                    this.clickImg(fs[index]);\n                                }}\n                                selectable={false}\n                                disableDelete={true}\n                                length={3}\n\n                            />\n\n                        </div>\n                    </div>\n\n                   <Flex>\n                       <Flex.Item><Button size='small' style={{background:'#5396a5' ,color:\"#ecfcee\",fontWeight: 'bold'}} onClick={()=> this.onClickComment(obj.postId)}>Comment</Button></Flex.Item>\n                   <Flex.Item><Button size='small' style={{background:'#5396a5',color:\"#ecfcee\",fontWeight: 'bold'}} onClick={this.likes}>Likes {!!!obj.likes?'('+obj.likes+')':\"\"}</Button></Flex.Item>\n                   </Flex>\n                </div>\n            );\n        };\n\n\n\n        return (\n            <div >\n                {this.state.isImgClick&&<ImageContainer currentImg={this.state.currentImg} picClose={this.picClose}/>}\n               <NavBar1 history={this.props.history}/>\n\n                <Flex style={{ background: \"white\",height:\"8vh\",position:'fixed',width:\"100%\", top:\"3vh\",zIndex:1}}>\n                    <Flex.Item style={{flex:'8'}}> <Slider\n                        style={{marginLeft:\"10px\",marginTop:'3vh'}}\n                    defaultValue={this.state.distance}\n                    min={0}\n                    max={30000}\n                    step={100}\n                    value={this.state.distance}\n                    onChange={(e)=>this.slider(e)}\n\n                />\n\n                </Flex.Item>\n                    <Flex.Item style={{flex:'3',marginTop:'3vh' ,background:'black',fontSize:\"20px\"} }>\n                        <InputItem\n                            type=\"number\"\n                            style={{background:'black'}}\n                            onChange={(e)=>{this.setState({distance:e})}}\n                            value={this.state.distance}\n                            extra=\"m\"\n                        ></InputItem>\n                    </Flex.Item>\n                    <Flex.Item style={{flex:'1'}} >\n                       <Icon onClick={this.check} size='small' style={{borderRadius:'100%',background:\"lightgrey\",marginTop:'3vh', textAlign:'center',width:'30px' ,fontSize:\"4vh\"} }type={'check'} />\n                    </Flex.Item>\n                </Flex>\n          <div>\n              {\n                  this.state.data.map((obj,index)=>{\n                      return(\n                          <div key={index} style={{ padding: '0 15px' }}>\n                              {index==0?  <div style={{height:'10vh' ,background:'white'}}></div>:<div/> /*show the 1st post completely*/}\n                              <div\n                                  style={{\n                                      lineHeight: '40px',\n                                      color: '#888',\n                                      fontSize: 15,\n                                      borderBottom: '1px solid #F6F6F6',\n\n                                  }}\n                              >{obj.place}</div>\n                              <div>\n                                  <Flex style={{  padding: '15px 0' }}>\n                                      <img style={{ height: '64px', marginRight: '15px' }} src={obj.userAvatar} alt=\"\" />\n                                      <div style={{ lineHeight: 1 }}>\n\n                                          <div><span style={{  fontSize: '20px',color: '#4e77a1',fontWeight: 'bold' }}>{obj.username}</span></div>\n                                          <div style={{ color: '#5396a5',fontSize: '18px',marginBottom: '8px',marginTop: '5px'  }}>{obj.time}</div>\n                                      </div>\n                                  </Flex>\n                                  <Flex>\n                                      <div style={{ marginBottom: '8px', fontWeight: 'bold' }}>{obj.content}</div>\n                                  </Flex>\n                                  <div>\n                                      <ImagePicker\n                                          files={obj.pictures_url.map((item)=>{\n                                              return {url:item}\n                                          })}\n\n                                          onChange={this.onChange}\n                                          onImageClick={(index, fs) => {\n                                              this.clickImg(fs[index]);\n                                          }}\n                                          selectable={false}\n                                          disableDelete={true}\n                                          length={3}\n\n                                      />\n\n                                  </div>\n                              </div>\n\n                              <Flex>\n                                  <Flex.Item><Button size='small' style={{background:'#5396a5' ,color:\"#ecfcee\",fontWeight: 'bold'}} onClick={()=> this.onClickComment(obj.postId)}>Comment</Button></Flex.Item>\n                                  <Flex.Item><Button size='small' style={{background:'#5396a5',color:\"#ecfcee\",fontWeight: 'bold'}} onClick={this.likes}>Likes {!!!obj.likes?'('+obj.likes.length+')':\"\"}</Button></Flex.Item>\n                              </Flex>\n                          </div>\n                      )\n                  })\n              }\n\n          </div>\n\n            </div>\n        );\n    }\n}\n\nexport default withAuthentication(PostPage);\n\n"]},"metadata":{},"sourceType":"module"}