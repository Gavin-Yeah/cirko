{"ast":null,"code":"import\"antd-mobile/lib/wing-blank/style\";import _WingBlank from\"antd-mobile/lib/wing-blank\";import\"antd-mobile/lib/image-picker/style\";import _ImagePicker from\"antd-mobile/lib/image-picker\";import\"antd-mobile/lib/switch/style\";import _Switch from\"antd-mobile/lib/switch\";import\"antd-mobile/lib/list/style\";import _List from\"antd-mobile/lib/list\";import\"antd-mobile/lib/textarea-item/style\";import _TextareaItem from\"antd-mobile/lib/textarea-item\";import\"antd-mobile/lib/nav-bar/style\";import _NavBar from\"antd-mobile/lib/nav-bar\";import _classCallCheck from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{withAuthentication}from\"../Session\";import add from\"../icons/add.png\";import{get_user_profile,savePostToDB}from\"../Firebase/upload\";import{get_location}from\"../utils/getLocation\";var CreatePost=/*#__PURE__*/function(_Component){_inherits(CreatePost,_Component);function CreatePost(){var _getPrototypeOf2;var _this;_classCallCheck(this,CreatePost);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(CreatePost)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={content:'',files:[],location:'',isSwitched:false};_this.contentRef=React.createRef();_this.add=function(){var addPost=_this.props.addPost;var content=_this.contentRef.current.value;var postObj={id:4,userName:'Jack',time:'10:31 10/10/2019',content:content,pics:[],likes:0};addPost(postObj);_this.setState({content:'',pics:[],multiple:true});};_this.onChange=function(event){_this.setState({content:event});};_this.onConfirm=function(){get_location(function(location){var firebase=_this.props.firebase;var uid=firebase.auth.currentUser.uid;var username=firebase.auth.currentUser.displayName;var callback=function callback(_ref){var posts_num=_ref.posts_num;console.log(location);var geocodeLatLng=firebase.functions.httpsCallable(\"geocodeLatLng\");geocodeLatLng(location).then(function(result){// Read result of the Cloud Function.\nvar place=null;if(_this.state.isSwitched){place=result.data;}savePostToDB(firebase,uid,username,posts_num||0,_this.state.content,_this.state.files,location,place,function(){_this.props.history.goBack();});}).catch(function(error){// Getting the Error details.\nvar code=error.code;var message=error.message;var details=error.details;console.log(code);console.log(message);console.log(details);// ...\n});};get_user_profile(firebase,uid,callback);});};_this.onChangePic=function(files,type,index){console.log(files,type,index);_this.setState({files:files});};_this.onAddImageClick=function(e){e.preventDefault();_this.setState({files:_this.state.files.concat({url:'https://zos.alipayobjects.com/rmsportal/hqQWgTXdrlmVVYi.jpeg',id:'3'})});};_this.onTabChange=function(key){console.log(key);};return _this;}_createClass(CreatePost,[{key:\"render\",value:function render(){var _this2=this;var onAddCanceledHandler=this.props.onAddCanceledHandler;var _this$state=this.state,content=_this$state.content,files=_this$state.files;return React.createElement(\"div\",null,React.createElement(_NavBar,{style:{backgroundColor:'#5396a5',borderBottomLeftRadius:'100%',borderBottomRightRadius:'100%',height:\"7vh\",position:'fixed',width:\"100%\",top:0,zIndex:1},mode:\"light\",leftContent:React.createElement(\"div\",{onClick:function onClick(){return _this2.props.history.goBack();},style:{width:'40px',marginTop:\"-20px\",marginLeft:'5px',color:'White',fontSize:'40px',fontWeight:'bold'}},\" <\"),rightContent:React.createElement(\"div\",{onClick:this.onConfirm,style:{width:'40px',marginTop:\"-10px\"}},React.createElement(\"img\",{src:add,style:{width:\"40px\"},alt:\"add\"}))},React.createElement(\"h1\",{style:{color:\"white\"}},\"Post\")),React.createElement(_List,null,React.createElement(\"div\",{style:{height:'70px',background:'white'}}),React.createElement(_TextareaItem,{placeholder:\"What's happening?\",autoHeight:true,labelNumber:5,onChange:this.onChange,rows:5,count:300})),React.createElement(\"div\",null,React.createElement(_List.Item,{style:{background:\"transparent\"},thumb:\"https://image.flaticon.com/icons/png/128/149/149060.png\",extra:React.createElement(_Switch,{checked:this.state.isSwitched,onChange:function onChange(){_this2.setState({isSwitched:!_this2.state.isSwitched});},platform:\"android\",color:\"#5396a5\"})},React.createElement(\"span\",{style:{color:\"#5396a5\"}},\"Your Position\"))),React.createElement(_WingBlank,null,React.createElement(_ImagePicker,{files:files,onChange:this.onChangePic,onImageClick:function onImageClick(index,fs){return console.log(index,fs);},selectable:files.length<9,multiple:true})));}}]);return CreatePost;}(Component);export default withAuthentication(CreatePost);","map":{"version":3,"sources":["/Users/jiadaye/workspace/cirko/src/components/CreatePost/index.js"],"names":["React","Component","withAuthentication","add","get_user_profile","savePostToDB","get_location","CreatePost","state","content","files","location","isSwitched","contentRef","createRef","addPost","props","current","value","postObj","id","userName","time","pics","likes","setState","multiple","onChange","event","onConfirm","firebase","uid","auth","currentUser","username","displayName","callback","posts_num","console","log","geocodeLatLng","functions","httpsCallable","then","result","place","data","history","goBack","catch","error","code","message","details","onChangePic","type","index","onAddImageClick","e","preventDefault","concat","url","onTabChange","key","onAddCanceledHandler","backgroundColor","borderBottomLeftRadius","borderBottomRightRadius","height","position","width","top","zIndex","marginTop","marginLeft","color","fontSize","fontWeight","background","fs","length"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { withAuthentication } from \"../Session\";\nimport { NavBar, Button, Icon, List, TextareaItem, Flex, ImagePicker, WingBlank, Switch } from 'antd-mobile'\nimport add from \"../icons/add.png\";\nimport { get_user_profile, savePostToDB } from \"../Firebase/upload\";\nimport { get_location } from \"../utils/getLocation\";\n\n\nclass CreatePost extends Component {\n    state = {\n        content: '',\n        files: [],\n        location: '',\n        isSwitched:false\n\n\n    }\n    contentRef = React.createRef();\n    add = () => {\n        let { addPost } = this.props\n        let content = this.contentRef.current.value;\n        const postObj = { id: 4, userName: 'Jack', time: '10:31 10/10/2019', content: content, pics: [], likes: 0 }\n        addPost(postObj)\n        this.setState({\n            content: '',\n            pics: [],\n            multiple: true\n        })\n\n    }\n\n\n    onChange = event => {\n        this.setState({ content: event });\n    };\n\n    onConfirm = () => {\n        get_location((location)=> {\n\n            const firebase = this.props.firebase;\n            const uid = firebase.auth.currentUser.uid;\n            const username = firebase.auth.currentUser.displayName;\n            const callback = ({posts_num}) => {\n                console.log(location);\n                let geocodeLatLng = firebase.functions.httpsCallable(\"geocodeLatLng\");\n\n                geocodeLatLng(location).then( (result)=> {\n                    // Read result of the Cloud Function.\n                    let place = null;\n                    if(this.state.isSwitched){\n                        place = result.data;\n                    }\n                    savePostToDB(firebase,uid,username,posts_num||0,this.state.content,this.state.files,location,place,() => {\n\n                        this.props.history.goBack();\n                    })\n\n                }).catch( (error) => {\n                    // Getting the Error details.\n                    var code = error.code;\n                    var message = error.message;\n                    var details = error.details;\n                    console.log(code);\n                    console.log(message);\n                    console.log(details);\n                    // ...\n                });\n\n\n            }\n\n\n\n                get_user_profile(firebase, uid, callback);\n\n        })\n\n\n\n        }\n\n    onChangePic = (files, type, index) => {\n        console.log(files, type, index);\n        this.setState({\n            files,\n        });\n    }\n    onAddImageClick = (e) => {\n        e.preventDefault();\n        this.setState({\n            files: this.state.files.concat({\n                url: 'https://zos.alipayobjects.com/rmsportal/hqQWgTXdrlmVVYi.jpeg',\n                id: '3',\n            }),\n        });\n    };\n    onTabChange = (key) => {\n        console.log(key);\n    };\n    render() {\n\n        const { onAddCanceledHandler } = this.props\n        let { content, files } = this.state\n        return (\n            <div>\n                <NavBar\n\n                    style={{backgroundColor: '#5396a5', borderBottomLeftRadius:'100%', borderBottomRightRadius:'100%',  height:\"7vh\",position:'fixed',width:\"100%\", top:0,zIndex:1}}\n\n                    mode=\"light\"\n                    leftContent={\n                        <div onClick={() => this.props.history.goBack()} style={{ width: '40px', marginTop: \"-20px\", marginLeft: '5px', color: 'White', fontSize: '40px', fontWeight: 'bold' }}> &lt;\n                        </div>\n                    }\n\n\n                    rightContent={\n\n                        <div onClick={this.onConfirm}  style={{width: '40px',marginTop:\"-10px\",}}><img src={add} style={{width:\"40px\"}} alt=\"add\"/>\n\n                        </div>\n\n                    }\n                ><h1 style={{ color: \"white\", }}>Post</h1>\n\n                </NavBar>\n\n\n                <List>\n                    <div style={{ height: '70px', background: 'white' }}></div>\n                    <TextareaItem\n\n                        placeholder={\"What's happening?\"}\n                        autoHeight\n                        labelNumber={5}\n                        onChange={this.onChange}\n                        rows={5}\n                        count={300}\n                    />\n                </List>\n                <div>\n\n                    <List.Item\n                        style={{background:\"transparent\"}}\n                        thumb={\"https://image.flaticon.com/icons/png/128/149/149060.png\"}\n                        extra={<Switch\n                            checked={this.state.isSwitched}\n                            onChange={()=>{this.setState({isSwitched:!this.state.isSwitched})}}\n                            platform=\"android\"\n                            color={\"#5396a5\"}\n\n                        />}\n                    ><span style={{color:\"#5396a5\"}}>Your Position</span></List.Item>\n\n                </div>\n                <WingBlank>\n\n                    <ImagePicker\n                        files={files}\n                        onChange={this.onChangePic}\n                        onImageClick={(index, fs) => console.log(index, fs)}\n                        selectable={files.length < 9}\n                        multiple={true}\n                    />\n                </WingBlank>\n\n            </div>\n\n        );\n    }\n}\nexport default withAuthentication(CreatePost);"]},"metadata":{},"sourceType":"module"}