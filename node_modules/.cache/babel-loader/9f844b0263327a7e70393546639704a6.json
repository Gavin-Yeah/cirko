{"ast":null,"code":"import\"antd-mobile/lib/button/style\";import _Button from\"antd-mobile/lib/button\";import\"antd-mobile/lib/input-item/style\";import _InputItem from\"antd-mobile/lib/input-item\";import _defineProperty from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/defineProperty\";import\"antd-mobile/lib/nav-bar/style\";import _NavBar from\"antd-mobile/lib/nav-bar\";import\"antd-mobile/lib/icon/style\";import _Icon from\"antd-mobile/lib/icon\";import _classCallCheck from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/jiadaye/workspace/cirko/node_modules/@babel/runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{Component}from'react';import{NavLink,withRouter}from'react-router-dom';import*as ROUTES from'../../constants/routes';import*as ROLES from'../../constants/roles';import{compose}from'recompose';import{withFirebase}from'../Firebase';import'./index.css';var SignUpPage=/*#__PURE__*/function(_Component){_inherits(SignUpPage,_Component);function SignUpPage(){_classCallCheck(this,SignUpPage);return _possibleConstructorReturn(this,_getPrototypeOf(SignUpPage).apply(this,arguments));}_createClass(SignUpPage,[{key:\"render\",value:function render(){var _this=this;return React.createElement(\"div\",null,React.createElement(_NavBar,{mode:\"light\",icon:React.createElement(_Icon,{type:\"left\"}),onLeftClick:function onLeftClick(){_this.props.history.goBack();}},\"Sign Up\"),React.createElement(\"div\",{className:\"icon1\"},React.createElement(\"img\",{className:\"image\",src:require(\"../icons/cirko-trans.png\"),alt:\"\"})),React.createElement(\"div\",{className:\"icon2\"},React.createElement(\"h2\",{className:\"appName\"},\"CIRKO\")),React.createElement(SignUpForm,null));}}]);return SignUpPage;}(Component);var INITIAL_STATE={userId:'',username:'',email:'',passwordOne:'',passwordTwo:'',error:null,isAdmin:false};var SignUpFormBase=/*#__PURE__*/function(_Component2){_inherits(SignUpFormBase,_Component2);function SignUpFormBase(props){var _this2;_classCallCheck(this,SignUpFormBase);_this2=_possibleConstructorReturn(this,_getPrototypeOf(SignUpFormBase).call(this,props));_this2.onSubmit=function(event){var _this2$state=_this2.state,username=_this2$state.username,email=_this2$state.email,passwordOne=_this2$state.passwordOne,isAdmin=_this2$state.isAdmin;var roles={};if(isAdmin){roles[ROLES.ADMIN]=ROLES.ADMIN;}_this2.props.firebase.doCreateUserWithEmailAndPassword(email,passwordOne).then(function(authUser){// Create a user in your Firebase realtime database\nreturn _this2.props.firebase.user(authUser.user.uid).set({avatarUrl:authUser.user.photoURL,following:[],followers:[],posts:[],posts_num:0,likes:[],userId:authUser.user.uid,username:username,email:email,roles:roles},{merge:true});}).then(function(authUser){_this2.setState(_objectSpread({},INITIAL_STATE));_this2.props.history.push(ROUTES.HOME);}).catch(function(error){_this2.setState({error:error});});event.preventDefault();};_this2.onChangeUsername=function(event){_this2.setState({username:event});};_this2.onChangeEmail=function(event){_this2.setState({email:event});};_this2.onChangePasswordOne=function(event){_this2.setState({passwordOne:event});};_this2.onChangePasswordTwo=function(event){_this2.setState({passwordTwo:event});};_this2.state=_objectSpread({},INITIAL_STATE);return _this2;}_createClass(SignUpFormBase,[{key:\"render\",value:function render(){var _this$state=this.state,username=_this$state.username,email=_this$state.email,passwordOne=_this$state.passwordOne,passwordTwo=_this$state.passwordTwo,error=_this$state.error,isAdmin=_this$state.isAdmin;var isInvalid=passwordOne!==passwordTwo||passwordOne===''||email===''||username==='';return React.createElement(\"form\",null,React.createElement(_InputItem,{name:\"username\",value:username,onChange:this.onChangeUsername,type:\"text\",placeholder:\"Full Name\"}),React.createElement(_InputItem,{name:\"email\",value:email,onChange:this.onChangeEmail,type:\"text\",placeholder:\"Email Address\"}),React.createElement(_InputItem,{name:\"passwordOne\",value:passwordOne,onChange:this.onChangePasswordOne,type:\"password\",placeholder:\"Password\"}),React.createElement(_InputItem,{name:\"passwordTwo\",value:passwordTwo,onChange:this.onChangePasswordTwo,type:\"password\",placeholder:\"Confirm Password\"}),React.createElement(_Button,{disabled:isInvalid,type:\"primary\",onClick:this.onSubmit},\"Sign Up\"),error&&React.createElement(\"p\",null,error.message));}}]);return SignUpFormBase;}(Component);var SignUpLink=function SignUpLink(){return React.createElement(_Button,null,\"Don't have an account? \",React.createElement(NavLink,{to:ROUTES.SIGN_UP},\"Sign Up\"));};var SignUpForm=compose(withRouter,withFirebase)(SignUpFormBase);export default SignUpPage;export{SignUpForm,SignUpLink};","map":{"version":3,"sources":["/Users/jiadaye/workspace/cirko/src/components/SignUp/index.js"],"names":["React","Component","NavLink","withRouter","ROUTES","ROLES","compose","withFirebase","SignUpPage","props","history","goBack","require","INITIAL_STATE","userId","username","email","passwordOne","passwordTwo","error","isAdmin","SignUpFormBase","onSubmit","event","state","roles","ADMIN","firebase","doCreateUserWithEmailAndPassword","then","authUser","user","uid","set","avatarUrl","photoURL","following","followers","posts","posts_num","likes","merge","setState","push","HOME","catch","preventDefault","onChangeUsername","onChangeEmail","onChangePasswordOne","onChangePasswordTwo","isInvalid","message","SignUpLink","SIGN_UP","SignUpForm"],"mappings":"6wDAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,OAAT,CAAkBC,UAAlB,KAAoC,kBAApC,CAEA,MAAO,GAAKC,CAAAA,MAAZ,KAAwB,wBAAxB,CACA,MAAO,GAAKC,CAAAA,KAAZ,KAAuB,uBAAvB,CACA,OAASC,OAAT,KAAwB,WAAxB,CAEA,OAASC,YAAT,KAA6B,aAA7B,CACA,MAAO,aAAP,C,GAGMC,CAAAA,U,oRACO,gBACL,MACI,gCACI,6BACI,IAAI,CAAC,OADT,CAEI,IAAI,CAAE,2BAAM,IAAI,CAAC,MAAX,EAFV,CAGI,WAAW,CAAE,sBAAM,CAAC,KAAI,CAACC,KAAL,CAAWC,OAAX,CAAmBC,MAAnB,GAA4B,CAHpD,YADJ,CAMI,2BAAK,SAAS,CAAE,OAAhB,EACI,2BAAK,SAAS,CAAE,OAAhB,CAAyB,GAAG,CAAEC,OAAO,CAAC,0BAAD,CAArC,CAAmE,GAAG,CAAC,EAAvE,EADJ,CANJ,CASI,2BAAK,SAAS,CAAE,OAAhB,EACI,0BAAI,SAAS,CAAE,SAAf,UADJ,CATJ,CAYI,oBAAC,UAAD,MAZJ,CADJ,CAgBH,C,wBAlBoBX,S,EAsBzB,GAAMY,CAAAA,aAAa,CAAG,CAClBC,MAAM,CAAC,EADW,CAElBC,QAAQ,CAAE,EAFQ,CAGlBC,KAAK,CAAE,EAHW,CAIlBC,WAAW,CAAE,EAJK,CAKlBC,WAAW,CAAE,EALK,CAMlBC,KAAK,CAAE,IANW,CAOlBC,OAAO,CAAE,KAPS,CAAtB,C,GAUMC,CAAAA,c,0EACF,wBAAYZ,KAAZ,CAAmB,iDACf,iFAAMA,KAAN,GADe,OAKnBa,QALmB,CAKR,SAAAC,KAAK,CAAI,kBACkC,OAAKC,KADvC,CACRT,QADQ,cACRA,QADQ,CACEC,KADF,cACEA,KADF,CACSC,WADT,cACSA,WADT,CACsBG,OADtB,cACsBA,OADtB,CAEhB,GAAMK,CAAAA,KAAK,CAAG,EAAd,CACA,GAAIL,OAAJ,CAAa,CACTK,KAAK,CAACpB,KAAK,CAACqB,KAAP,CAAL,CAAqBrB,KAAK,CAACqB,KAA3B,CACH,CACD,OAAKjB,KAAL,CAAWkB,QAAX,CACKC,gCADL,CACsCZ,KADtC,CAC6CC,WAD7C,EAEKY,IAFL,CAEU,SAAAC,QAAQ,CAAI,CACd;AACA,MAAO,QAAKrB,KAAL,CAAWkB,QAAX,CACFI,IADE,CACGD,QAAQ,CAACC,IAAT,CAAcC,GADjB,EAEFC,GAFE,CAEE,CACGC,SAAS,CAACJ,QAAQ,CAACC,IAAT,CAAcI,QAD3B,CAEGC,SAAS,CAAE,EAFd,CAGGC,SAAS,CAAE,EAHd,CAIGC,KAAK,CAAE,EAJV,CAKGC,SAAS,CAAE,CALd,CAMGC,KAAK,CAAC,EANT,CAOG1B,MAAM,CAACgB,QAAQ,CAACC,IAAT,CAAcC,GAPxB,CAQGjB,QAAQ,CAARA,QARH,CASGC,KAAK,CAALA,KATH,CAUGS,KAAK,CAALA,KAVH,CAFF,CAcC,CAACgB,KAAK,CAAE,IAAR,CAdD,CAAP,CAgBH,CApBL,EAqBKZ,IArBL,CAqBU,SAAAC,QAAQ,CAAI,CACd,OAAKY,QAAL,kBAAmB7B,aAAnB,GACA,OAAKJ,KAAL,CAAWC,OAAX,CAAmBiC,IAAnB,CAAwBvC,MAAM,CAACwC,IAA/B,EACH,CAxBL,EAyBKC,KAzBL,CAyBW,SAAA1B,KAAK,CAAI,CACZ,OAAKuB,QAAL,CAAc,CAAEvB,KAAK,CAALA,KAAF,CAAd,EACH,CA3BL,EA4BAI,KAAK,CAACuB,cAAN,GAIH,CA3CkB,QA4CnBC,gBA5CmB,CA4CA,SAAAxB,KAAK,CAAI,CACxB,OAAKmB,QAAL,CAAc,CAAE3B,QAAQ,CAAEQ,KAAZ,CAAd,EACH,CA9CkB,QA+CnByB,aA/CmB,CA+CH,SAAAzB,KAAK,CAAI,CACrB,OAAKmB,QAAL,CAAc,CAAE1B,KAAK,CAAEO,KAAT,CAAd,EACH,CAjDkB,QAkDnB0B,mBAlDmB,CAkDG,SAAA1B,KAAK,CAAI,CAC3B,OAAKmB,QAAL,CAAc,CAAEzB,WAAW,CAAEM,KAAf,CAAd,EACH,CApDkB,QAqDnB2B,mBArDmB,CAqDG,SAAA3B,KAAK,CAAI,CAC3B,OAAKmB,QAAL,CAAc,CAAExB,WAAW,CAAEK,KAAf,CAAd,EACH,CAvDkB,CAEf,OAAKC,KAAL,kBAAkBX,aAAlB,EAFe,cAGlB,C,kEAuDQ,iBAQD,KAAKW,KARJ,CAEDT,QAFC,aAEDA,QAFC,CAGDC,KAHC,aAGDA,KAHC,CAIDC,WAJC,aAIDA,WAJC,CAKDC,WALC,aAKDA,WALC,CAMDC,KANC,aAMDA,KANC,CAODC,OAPC,aAODA,OAPC,CAWL,GAAM+B,CAAAA,SAAS,CACXlC,WAAW,GAAKC,WAAhB,EACAD,WAAW,GAAK,EADhB,EAEAD,KAAK,GAAK,EAFV,EAGAD,QAAQ,GAAK,EAJjB,CAMA,MACI,iCACI,gCACI,IAAI,CAAC,UADT,CAEI,KAAK,CAAEA,QAFX,CAGI,QAAQ,CAAE,KAAKgC,gBAHnB,CAII,IAAI,CAAC,MAJT,CAKI,WAAW,CAAC,WALhB,EADJ,CAQI,gCACI,IAAI,CAAC,OADT,CAEI,KAAK,CAAE/B,KAFX,CAGI,QAAQ,CAAE,KAAKgC,aAHnB,CAII,IAAI,CAAC,MAJT,CAKI,WAAW,CAAC,eALhB,EARJ,CAeI,gCACI,IAAI,CAAC,aADT,CAEI,KAAK,CAAE/B,WAFX,CAGI,QAAQ,CAAE,KAAKgC,mBAHnB,CAII,IAAI,CAAC,UAJT,CAKI,WAAW,CAAC,UALhB,EAfJ,CAsBI,gCACI,IAAI,CAAC,aADT,CAEI,KAAK,CAAE/B,WAFX,CAGI,QAAQ,CAAE,KAAKgC,mBAHnB,CAII,IAAI,CAAC,UAJT,CAKI,WAAW,CAAC,kBALhB,EAtBJ,CAiCI,6BAAQ,QAAQ,CAAEC,SAAlB,CAA6B,IAAI,CAAE,SAAnC,CAA8C,OAAO,CAAE,KAAK7B,QAA5D,YAjCJ,CAkCKH,KAAK,EAAI,6BAAIA,KAAK,CAACiC,OAAV,CAlCd,CADJ,CAsCH,C,4BAlHwBnD,S,EAqH7B,GAAMoD,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,SACf,4DAC2B,oBAAC,OAAD,EAAS,EAAE,CAAEjD,MAAM,CAACkD,OAApB,YAD3B,CADe,EAAnB,CAKA,GAAMC,CAAAA,UAAU,CAAGjD,OAAO,CACtBH,UADsB,CAEtBI,YAFsB,CAAP,CAGjBc,cAHiB,CAAnB,CAIA,cAAeb,CAAAA,UAAf,CACA,OAAS+C,UAAT,CAAqBF,UAArB","sourcesContent":["import React, { Component } from 'react';\nimport { NavLink, withRouter } from 'react-router-dom';\n\nimport * as ROUTES from '../../constants/routes';\nimport * as ROLES from '../../constants/roles';\nimport { compose } from 'recompose';\nimport { Button, Icon, InputItem, NavBar } from 'antd-mobile'\nimport { withFirebase } from '../Firebase';\nimport './index.css'\n\n\nclass SignUpPage extends Component {\n    render() {\n        return (\n            <div>\n                <NavBar\n                    mode=\"light\"\n                    icon={<Icon type=\"left\" />}\n                    onLeftClick={() => {this.props.history.goBack()}}\n                >Sign Up</NavBar>\n                <div className={\"icon1\"}>\n                    <img className={\"image\"} src={require(\"../icons/cirko-trans.png\")} alt=\"\"/>\n                </div>\n                <div className={\"icon2\"}>\n                    <h2 className={\"appName\"}>CIRKO</h2>\n                </div>\n                <SignUpForm />\n            </div>\n        );\n    }\n}\n\n\nconst INITIAL_STATE = {\n    userId:'',\n    username: '',\n    email: '',\n    passwordOne: '',\n    passwordTwo: '',\n    error: null,\n    isAdmin: false,\n};\n\nclass SignUpFormBase extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { ...INITIAL_STATE };\n    }\n\n    onSubmit = event => {\n        const { username, email, passwordOne, isAdmin } = this.state;\n        const roles = {};\n        if (isAdmin) {\n            roles[ROLES.ADMIN] = ROLES.ADMIN;\n        }\n        this.props.firebase\n            .doCreateUserWithEmailAndPassword(email, passwordOne)\n            .then(authUser => {\n                // Create a user in your Firebase realtime database\n                return this.props.firebase\n                    .user(authUser.user.uid)\n                    .set({\n                            avatarUrl:authUser.user.photoURL,\n                            following: [],\n                            followers: [],\n                            posts: [],\n                            posts_num: 0,\n                            likes:[],\n                            userId:authUser.user.uid,\n                            username,\n                            email,\n                            roles,\n                        },\n                        {merge: true},\n                    );\n            })\n            .then(authUser => {\n                this.setState({ ...INITIAL_STATE });\n                this.props.history.push(ROUTES.HOME);\n            })\n            .catch(error => {\n                this.setState({ error });\n            });\n        event.preventDefault();\n\n\n\n    }\n    onChangeUsername = event => {\n        this.setState({ username: event});\n    };\n    onChangeEmail = event => {\n        this.setState({ email: event });\n    };\n    onChangePasswordOne = event => {\n        this.setState({ passwordOne: event });\n    };\n    onChangePasswordTwo = event => {\n        this.setState({ passwordTwo: event });\n    };\n\n\n    render() {\n        const {\n            username,\n            email,\n            passwordOne,\n            passwordTwo,\n            error,\n            isAdmin,\n        } = this.state;\n\n\n        const isInvalid =\n            passwordOne !== passwordTwo ||\n            passwordOne === '' ||\n            email === '' ||\n            username === '';\n\n        return (\n            <form >\n                <InputItem\n                    name=\"username\"\n                    value={username}\n                    onChange={this.onChangeUsername}\n                    type=\"text\"\n                    placeholder=\"Full Name\"\n                ></InputItem>\n                <InputItem\n                    name=\"email\"\n                    value={email}\n                    onChange={this.onChangeEmail}\n                    type=\"text\"\n                    placeholder=\"Email Address\"\n                ></InputItem>\n                <InputItem\n                    name=\"passwordOne\"\n                    value={passwordOne}\n                    onChange={this.onChangePasswordOne}\n                    type=\"password\"\n                    placeholder=\"Password\"\n                ></InputItem>\n                <InputItem\n                    name=\"passwordTwo\"\n                    value={passwordTwo}\n                    onChange={this.onChangePasswordTwo}\n                    type=\"password\"\n                    placeholder=\"Confirm Password\"\n\n                ></InputItem>\n\n\n\n                <Button disabled={isInvalid} type={\"primary\"} onClick={this.onSubmit}>Sign Up</Button>\n                {error && <p>{error.message}</p>}\n            </form>\n        );\n    }\n}\n\nconst SignUpLink = () => (\n    <Button>\n        Don't have an account? <NavLink to={ROUTES.SIGN_UP}>Sign Up</NavLink>\n    </Button>\n);\nconst SignUpForm = compose(\n    withRouter,\n    withFirebase,\n)(SignUpFormBase);\nexport default SignUpPage;\nexport { SignUpForm, SignUpLink };"]},"metadata":{},"sourceType":"module"}